{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Mounith%20Varma%20Akkala/OneDrive/Desktop/New%20folder%20%282%29/v0-smart-pharmacy-ui/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies()\r\n\r\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\r\n    cookies: {\r\n      getAll() {\r\n        return cookieStore.getAll()\r\n      },\r\n      setAll(cookiesToSet) {\r\n        try {\r\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\r\n        } catch {\r\n          // setAll called from Server Component, can be ignored with proxy\r\n        }\r\n      },\r\n    },\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,iEAAiE;gBACnE;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Mounith%20Varma%20Akkala/OneDrive/Desktop/New%20folder%20%282%29/v0-smart-pharmacy-ui/app/api/reset-database/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { createClient } from '@/lib/supabase/server'\r\n\r\nexport async function POST() {\r\n  try {\r\n    const supabase = await createClient()\r\n\r\n    // Step 1: Drop existing tables in correct order (handle foreign keys)\r\n    const dropTables = [\r\n      'sales',\r\n      'low_stock_requests', \r\n      'drug_substitutions',\r\n      'supplier_medicines',\r\n      'medicines',\r\n      'suppliers',\r\n      'users'\r\n    ]\r\n\r\n    const dropResults = []\r\n    for (const table of dropTables) {\r\n      try {\r\n        const { error } = await supabase\r\n          .from(table)\r\n          .delete()\r\n          .neq('id', '00000000-0000-0000-0000-000000000000') // Delete all records\r\n\r\n        if (error && !error.message.includes('does not exist')) {\r\n          console.warn(`Warning dropping table ${table}:`, error.message)\r\n        }\r\n        dropResults.push({ table, success: true })\r\n      } catch (err) {\r\n        console.warn(`Could not clear table ${table}:`, err)\r\n        dropResults.push({ table, success: false, error: err })\r\n      }\r\n    }\r\n\r\n    // Step 2: Create sample data directly using Supabase client\r\n    \r\n    // Create sample suppliers\r\n    const { data: suppliers, error: suppliersError } = await supabase\r\n      .from('suppliers')\r\n      .insert([\r\n        {\r\n          name: 'MediSupply Co.',\r\n          contact_person: 'Rajesh Kumar',\r\n          email: 'contact@medisupply.com',\r\n          phone: '+91-9876543213',\r\n          address: '123 Medical Street',\r\n          city: 'Mumbai',\r\n          state: 'Maharashtra',\r\n          postal_code: '400001',\r\n          rating: 4.5\r\n        },\r\n        {\r\n          name: 'PharmaCorp Ltd.',\r\n          contact_person: 'Priya Sharma', \r\n          email: 'info@pharmacorp.com',\r\n          phone: '+91-9876543214',\r\n          address: '456 Health Avenue',\r\n          city: 'Delhi',\r\n          state: 'Delhi',\r\n          postal_code: '110001',\r\n          rating: 4.2\r\n        },\r\n        {\r\n          name: 'HealthFirst Distributors',\r\n          contact_person: 'Amit Patel',\r\n          email: 'sales@healthfirst.com',\r\n          phone: '+91-9876543215',\r\n          address: '789 Wellness Road',\r\n          city: 'Bangalore',\r\n          state: 'Karnataka',\r\n          postal_code: '560001',\r\n          rating: 4.7\r\n        }\r\n      ])\r\n      .select()\r\n\r\n    if (suppliersError) {\r\n      console.error('Error creating suppliers:', suppliersError)\r\n    }\r\n\r\n    // Create sample medicines\r\n    const { data: medicines, error: medicinesError } = await supabase\r\n      .from('medicines')\r\n      .insert([\r\n        {\r\n          name: 'Paracetamol 500mg',\r\n          generic_name: 'Paracetamol',\r\n          brand: 'Crocin',\r\n          category: 'Pain Relief',\r\n          dosage_form: 'Tablet',\r\n          strength: '500mg',\r\n          unit_price: 5.00,\r\n          cost_price: 3.50,\r\n          quantity: 500,\r\n          min_stock_level: 50,\r\n          expiry_date: '2025-12-31',\r\n          manufacturer: 'GSK',\r\n          prescription_required: false\r\n        },\r\n        {\r\n          name: 'Amoxicillin 250mg',\r\n          generic_name: 'Amoxicillin',\r\n          brand: 'Amoxil',\r\n          category: 'Antibiotics',\r\n          dosage_form: 'Capsule',\r\n          strength: '250mg',\r\n          unit_price: 15.00,\r\n          cost_price: 10.00,\r\n          quantity: 200,\r\n          min_stock_level: 30,\r\n          expiry_date: '2025-06-30',\r\n          manufacturer: 'Cipla',\r\n          prescription_required: true\r\n        },\r\n        {\r\n          name: 'Cetirizine 10mg',\r\n          generic_name: 'Cetirizine',\r\n          brand: 'Zyrtec',\r\n          category: 'Antihistamine',\r\n          dosage_form: 'Tablet',\r\n          strength: '10mg',\r\n          unit_price: 8.00,\r\n          cost_price: 5.50,\r\n          quantity: 300,\r\n          min_stock_level: 40,\r\n          expiry_date: '2025-09-15',\r\n          manufacturer: 'Dr. Reddy',\r\n          prescription_required: false\r\n        },\r\n        {\r\n          name: 'Metformin 500mg',\r\n          generic_name: 'Metformin',\r\n          brand: 'Glucophage',\r\n          category: 'Diabetes',\r\n          dosage_form: 'Tablet',\r\n          strength: '500mg',\r\n          unit_price: 12.00,\r\n          cost_price: 8.00,\r\n          quantity: 150,\r\n          min_stock_level: 25,\r\n          expiry_date: '2025-11-20',\r\n          manufacturer: 'Sun Pharma',\r\n          prescription_required: true\r\n        },\r\n        {\r\n          name: 'Atorvastatin 20mg',\r\n          generic_name: 'Atorvastatin',\r\n          brand: 'Lipitor',\r\n          category: 'Cardiac',\r\n          dosage_form: 'Tablet',\r\n          strength: '20mg',\r\n          unit_price: 25.00,\r\n          cost_price: 18.00,\r\n          quantity: 100,\r\n          min_stock_level: 20,\r\n          expiry_date: '2025-08-10',\r\n          manufacturer: 'Pfizer',\r\n          prescription_required: true\r\n        },\r\n        {\r\n          name: 'Vitamin D3 60000 IU',\r\n          generic_name: 'Cholecalciferol',\r\n          brand: 'Calcirol',\r\n          category: 'Vitamins',\r\n          dosage_form: 'Capsule',\r\n          strength: '60000 IU',\r\n          unit_price: 35.00,\r\n          cost_price: 25.00,\r\n          quantity: 80,\r\n          min_stock_level: 15,\r\n          expiry_date: '2025-10-05',\r\n          manufacturer: 'Cadila',\r\n          prescription_required: false\r\n        },\r\n        {\r\n          name: 'Omeprazole 20mg',\r\n          generic_name: 'Omeprazole',\r\n          brand: 'Prilosec',\r\n          category: 'Gastric',\r\n          dosage_form: 'Capsule',\r\n          strength: '20mg',\r\n          unit_price: 18.00,\r\n          cost_price: 12.00,\r\n          quantity: 120,\r\n          min_stock_level: 20,\r\n          expiry_date: '2025-07-25',\r\n          manufacturer: 'Lupin',\r\n          prescription_required: true\r\n        },\r\n        {\r\n          name: 'Aspirin 75mg',\r\n          generic_name: 'Aspirin',\r\n          brand: 'Ecosprin',\r\n          category: 'Cardiac',\r\n          dosage_form: 'Tablet',\r\n          strength: '75mg',\r\n          unit_price: 6.00,\r\n          cost_price: 4.00,\r\n          quantity: 400,\r\n          min_stock_level: 50,\r\n          expiry_date: '2025-12-15',\r\n          manufacturer: 'USV',\r\n          prescription_required: false\r\n        },\r\n        {\r\n          name: 'Ibuprofen 400mg',\r\n          generic_name: 'Ibuprofen',\r\n          brand: 'Brufen',\r\n          category: 'Pain Relief',\r\n          dosage_form: 'Tablet',\r\n          strength: '400mg',\r\n          unit_price: 10.00,\r\n          cost_price: 7.00,\r\n          quantity: 250,\r\n          min_stock_level: 35,\r\n          expiry_date: '2025-09-30',\r\n          manufacturer: 'Abbott',\r\n          prescription_required: false\r\n        },\r\n        {\r\n          name: 'Azithromycin 500mg',\r\n          generic_name: 'Azithromycin',\r\n          brand: 'Zithromax',\r\n          category: 'Antibiotics',\r\n          dosage_form: 'Tablet',\r\n          strength: '500mg',\r\n          unit_price: 45.00,\r\n          cost_price: 32.00,\r\n          quantity: 75,\r\n          min_stock_level: 15,\r\n          expiry_date: '2025-05-20',\r\n          manufacturer: 'Pfizer',\r\n          prescription_required: true\r\n        }\r\n      ])\r\n      .select()\r\n\r\n    if (medicinesError) {\r\n      console.error('Error creating medicines:', medicinesError)\r\n    }\r\n\r\n    // Create sample sales data\r\n    if (medicines && medicines.length > 0) {\r\n      const salesData = []\r\n      const customers = [\r\n        'Rahul Sharma', 'Priya Patel', 'Amit Kumar', 'Sunita Singh', 'Vikram Gupta',\r\n        'Neha Agarwal', 'Ravi Verma', 'Kavita Joshi', 'Suresh Reddy', 'Anjali Mehta'\r\n      ]\r\n      const paymentMethods = ['cash', 'card', 'upi', 'insurance']\r\n\r\n      // Create 3 sales per medicine for the last 30 days\r\n      for (const medicine of medicines) {\r\n        for (let i = 0; i < 3; i++) {\r\n          const quantity = Math.floor(Math.random() * 5) + 1\r\n          const totalPrice = quantity * medicine.unit_price\r\n          const taxAmount = totalPrice * 0.18\r\n          const finalAmount = totalPrice + taxAmount\r\n          \r\n          // Random date in last 30 days\r\n          const saleDate = new Date()\r\n          saleDate.setDate(saleDate.getDate() - Math.floor(Math.random() * 30))\r\n\r\n          salesData.push({\r\n            medicine_id: medicine.id,\r\n            quantity,\r\n            unit_price: medicine.unit_price,\r\n            total_price: totalPrice,\r\n            discount_amount: 0,\r\n            tax_amount: taxAmount,\r\n            final_amount: finalAmount,\r\n            payment_method: paymentMethods[Math.floor(Math.random() * paymentMethods.length)],\r\n            customer_name: customers[Math.floor(Math.random() * customers.length)],\r\n            customer_phone: `+91-${9000000000 + Math.floor(Math.random() * 999999999)}`,\r\n            sale_date: saleDate.toISOString(),\r\n            status: 'completed'\r\n          })\r\n        }\r\n      }\r\n\r\n      const { error: salesError } = await supabase\r\n        .from('sales')\r\n        .insert(salesData)\r\n\r\n      if (salesError) {\r\n        console.error('Error creating sales:', salesError)\r\n      }\r\n    }\r\n\r\n    // Verify the setup\r\n    const { count: medicinesCount } = await supabase\r\n      .from('medicines')\r\n      .select('*', { count: 'exact', head: true })\r\n\r\n    const { count: salesCount } = await supabase\r\n      .from('sales')\r\n      .select('*', { count: 'exact', head: true })\r\n\r\n    const { count: suppliersCount } = await supabase\r\n      .from('suppliers')\r\n      .select('*', { count: 'exact', head: true })\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: 'Fresh database created successfully!',\r\n      details: {\r\n        medicinesCount: medicinesCount || 0,\r\n        salesCount: salesCount || 0,\r\n        suppliersCount: suppliersCount || 0,\r\n        dropResults\r\n      }\r\n    })\r\n\r\n  } catch (error) {\r\n    console.error('Database reset error:', error)\r\n    return NextResponse.json({\r\n      success: false,\r\n      error: error instanceof Error ? error.message : 'Unknown error occurred',\r\n      message: 'Failed to reset database'\r\n    }, { status: 500 })\r\n  }\r\n}"],"names":[],"mappings":"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"}}]
}