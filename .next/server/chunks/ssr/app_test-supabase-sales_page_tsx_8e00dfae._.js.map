{"version":3,"sources":["../../../../app/test-supabase-sales/page.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport { Button } from '@/components/ui/button'\r\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'\r\nimport { createClient } from '@/lib/supabase/client'\r\n\r\nexport default function TestSupabaseSalesPage() {\r\n  const [salesData, setSalesData] = useState<any[]>([])\r\n  const [salesStats, setSalesStats] = useState<any>(null)\r\n  const [loading, setLoading] = useState(false)\r\n  const [error, setError] = useState<string>('')\r\n  const supabase = createClient()\r\n\r\n  const fetchSalesData = async () => {\r\n    setLoading(true)\r\n    setError('')\r\n    \r\n    try {\r\n      // Fetch sales data with medicine details\r\n      const { data: sales, error: salesError } = await supabase\r\n        .from('sales')\r\n        .select(`\r\n          id,\r\n          quantity,\r\n          total_price,\r\n          sale_date,\r\n          medicines (\r\n            name,\r\n            category,\r\n            price\r\n          )\r\n        `)\r\n        .order('sale_date', { ascending: false })\r\n        .limit(10)\r\n\r\n      if (salesError) {\r\n        throw salesError\r\n      }\r\n\r\n      setSalesData(sales || [])\r\n\r\n      // Calculate stats\r\n      const today = new Date().toISOString().split('T')[0]\r\n      const { data: todaySales } = await supabase\r\n        .from('sales')\r\n        .select('quantity, total_price')\r\n        .gte('sale_date', `${today}T00:00:00`)\r\n        .lte('sale_date', `${today}T23:59:59`)\r\n\r\n      const { count: totalSales } = await supabase\r\n        .from('sales')\r\n        .select('*', { count: 'exact', head: true })\r\n\r\n      const todayQuantity = todaySales?.reduce((sum, s) => sum + (s.quantity || 0), 0) || 0\r\n      const todayRevenue = todaySales?.reduce((sum, s) => sum + (s.total_price || 0), 0) || 0\r\n\r\n      setSalesStats({\r\n        totalSales: totalSales || 0,\r\n        todayQuantity,\r\n        todayRevenue,\r\n        hasData: (sales?.length || 0) > 0\r\n      })\r\n\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Unknown error')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  const addSampleSales = async () => {\r\n    setLoading(true)\r\n    try {\r\n      const response = await fetch('/api/add-sample-sales', {\r\n        method: 'POST'\r\n      })\r\n      const result = await response.json()\r\n      \r\n      if (result.success) {\r\n        await fetchSalesData() // Refresh data\r\n      } else {\r\n        setError(result.error || 'Failed to add sample sales')\r\n      }\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Network error')\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    fetchSalesData()\r\n  }, [])\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6 space-y-6\">\r\n      <h1 className=\"text-3xl font-bold\">Supabase Sales Data Test</h1>\r\n      \r\n      <div className=\"grid gap-6 md:grid-cols-2\">\r\n        {/* Sales Statistics */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Sales Statistics</CardTitle>\r\n            <CardDescription>Current sales data from Supabase</CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            {salesStats && (\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span>Total Sales Records:</span>\r\n                  <span className=\"font-medium\">{salesStats.totalSales}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Today's Units Sold:</span>\r\n                  <span className=\"font-medium\">{salesStats.todayQuantity}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Today's Revenue:</span>\r\n                  <span className=\"font-medium\">${salesStats.todayRevenue?.toFixed(2) || '0.00'}</span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span>Data Status:</span>\r\n                  <span className={`font-medium ${salesStats.hasData ? 'text-green-600' : 'text-red-600'}`}>\r\n                    {salesStats.hasData ? 'Has Data' : 'No Data'}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"flex space-x-2\">\r\n              <Button onClick={fetchSalesData} disabled={loading}>\r\n                Refresh Data\r\n              </Button>\r\n              <Button onClick={addSampleSales} disabled={loading} variant=\"outline\">\r\n                Add Sample Sales\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Error Display */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle>Status</CardTitle>\r\n            <CardDescription>Connection and data status</CardDescription>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {error && (\r\n              <div className=\"p-3 bg-red-50 border border-red-200 rounded-md\">\r\n                <p className=\"text-sm text-red-700\">{error}</p>\r\n              </div>\r\n            )}\r\n            \r\n            {!error && salesStats && (\r\n              <div className=\"p-3 bg-green-50 border border-green-200 rounded-md\">\r\n                <p className=\"text-sm text-green-700\">\r\n                  âœ… Successfully connected to Supabase sales table\r\n                </p>\r\n              </div>\r\n            )}\r\n            \r\n            {loading && (\r\n              <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-md\">\r\n                <p className=\"text-sm text-blue-700\">Loading...</p>\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Sales Data Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Recent Sales Data</CardTitle>\r\n          <CardDescription>Last 10 sales records from your Supabase database</CardDescription>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {salesData.length > 0 ? (\r\n            <div className=\"overflow-x-auto\">\r\n              <table className=\"w-full text-sm\">\r\n                <thead>\r\n                  <tr className=\"border-b\">\r\n                    <th className=\"text-left p-2\">Date</th>\r\n                    <th className=\"text-left p-2\">Medicine</th>\r\n                    <th className=\"text-left p-2\">Category</th>\r\n                    <th className=\"text-left p-2\">Quantity</th>\r\n                    <th className=\"text-left p-2\">Total Price</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {salesData.map((sale, index) => (\r\n                    <tr key={sale.id} className=\"border-b\">\r\n                      <td className=\"p-2\">\r\n                        {new Date(sale.sale_date).toLocaleDateString()}\r\n                      </td>\r\n                      <td className=\"p-2\">{sale.medicines?.name || 'Unknown'}</td>\r\n                      <td className=\"p-2\">{sale.medicines?.category || 'N/A'}</td>\r\n                      <td className=\"p-2\">{sale.quantity}</td>\r\n                      <td className=\"p-2\">${sale.total_price?.toFixed(2) || '0.00'}</td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          ) : (\r\n            <div className=\"text-center py-8 text-gray-500\">\r\n              <p>No sales data found</p>\r\n              <Button onClick={addSampleSales} className=\"mt-4\" disabled={loading}>\r\n                Add Sample Sales Data\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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"}