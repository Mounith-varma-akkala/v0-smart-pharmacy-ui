module.exports=[63865,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),s=e.i(59756),i=e.i(61916),n=e.i(14444),o=e.i(37092),l=e.i(69741),c=e.i(16795),d=e.i(87718),u=e.i(95169),p=e.i(32084),m=e.i(66012),h=e.i(70101),f=e.i(26937),g=e.i(10372),y=e.i(93695);e.i(52474);var _=e.i(5232),v=e.i(89171);let w=(0,e.i(24389).createClient)("https://ltxmhawsjyjshnmtqgsx.supabase.co","your_supabase_anon_key_here");async function R(e){try{let{action:t}=await e.json();switch(t){case"check_readiness":return await b();case"setup_sample_data":return await x();case"verify_schema":return await C();default:return v.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){return console.error("Database setup error:",e),v.NextResponse.json({error:"Database setup failed"},{status:500})}}async function b(){try{var e;let t,r,a,s=[],i=["medicines","inventory","sales","alerts"];for(let e of i)try{let{count:t,error:r}=await w.from(e).select("*",{count:"exact",head:!0});s.push({table:e,exists:!r,count:t||0,status:r?"missing":"ready"})}catch(t){s.push({table:e,exists:!1,count:0,status:"error"})}for(let e of["suppliers","inventory_batches","drug_substitutes","low_stock_requests"])try{let{count:t,error:r}=await w.from(e).select("*",{count:"exact",head:!0});s.push({table:e,exists:!r,count:t||0,status:r?"missing":"ready"})}catch(t){s.push({table:e,exists:!1,count:0,status:"error"})}let n=s.filter(e=>"ready"===e.status).length,o=s.length,l=n>=i.length;return v.NextResponse.json({success:!0,isReady:l,readiness:`${n}/${o} tables ready`,checks:s,recommendations:(e=s,t=[],r=e.filter(e=>["medicines","inventory","sales","alerts"].includes(e.table)&&"ready"!==e.status),a=e.filter(e=>["suppliers","inventory_batches","drug_substitutes","low_stock_requests"].includes(e.table)&&"ready"!==e.status),r.length>0&&t.push("Run the basic database schema setup first"),a.length>0&&t.push("Run scripts/pharmacy_features_schema.sql to create smart pharmacy tables"),e.filter(e=>e.exists&&0===e.count).length>0&&t.push('Use the "Setup Sample Data" button to populate basic data'),0===t.length&&t.push("Database is ready! You can now populate smart pharmacy features."),t)})}catch(e){return console.error("Error checking database readiness:",e),v.NextResponse.json({error:"Failed to check database readiness"},{status:500})}}async function x(){try{let e=[],{data:t}=await w.from("medicines").select("id").limit(1);if(t&&0!==t.length)e.push("Medicines already exist, skipping creation");else{let{data:t,error:r}=await w.from("medicines").insert([{name:"Paracetamol 500mg",composition:"Paracetamol 500mg",price:25,description:"Pain reliever and fever reducer",requires_prescription:!1},{name:"Amoxicillin 250mg",composition:"Amoxicillin 250mg",price:85,description:"Antibiotic for bacterial infections",requires_prescription:!0},{name:"Ibuprofen 400mg",composition:"Ibuprofen 400mg",price:35,description:"Anti-inflammatory pain reliever",requires_prescription:!1},{name:"Metformin 500mg",composition:"Metformin HCl 500mg",price:45,description:"Diabetes medication",requires_prescription:!0},{name:"Omeprazole 20mg",composition:"Omeprazole 20mg",price:65,description:"Proton pump inhibitor for acid reflux",requires_prescription:!0},{name:"Cetirizine 10mg",composition:"Cetirizine HCl 10mg",price:15,description:"Antihistamine for allergies",requires_prescription:!1},{name:"Atorvastatin 20mg",composition:"Atorvastatin 20mg",price:125,description:"Cholesterol-lowering medication",requires_prescription:!0},{name:"Aspirin 75mg",composition:"Acetylsalicylic Acid 75mg",price:20,description:"Blood thinner and pain reliever",requires_prescription:!1}]).select();if(r)throw r;e.push(`Created ${t.length} sample medicines`)}let{data:r}=await w.from("medicines").select("id").limit(10);if(r&&r.length>0){let t=r.map(e=>({medicine_id:e.id,quantity:Math.floor(200*Math.random())+50,reorder_level:Math.floor(30*Math.random())+20,last_updated:new Date().toISOString()})),{data:a}=await w.from("inventory").select("medicine_id").in("medicine_id",r.map(e=>e.id)),s=a?.map(e=>e.medicine_id)||[],i=t.filter(e=>!s.includes(e.medicine_id));if(i.length>0){let{error:t}=await w.from("inventory").insert(i);if(t)throw t;e.push(`Created ${i.length} inventory records`)}else e.push("Inventory records already exist")}let{data:a}=await w.from("inventory").select(`
        medicine_id,
        medicines (id, name, price)
      `).limit(8);if(a&&a.length>0){let t=[],r=["John Smith","Sarah Johnson","Mike Wilson","Lisa Brown","David Lee"];for(let e of a){let a=Math.floor(3*Math.random())+3;for(let s=0;s<a;s++){let a=Math.floor(5*Math.random())+1,s=new Date;s.setDate(s.getDate()-Math.floor(90*Math.random())),t.push({medicine_id:e.medicine_id,quantity:a,unit_price:e.medicines.price,total_amount:a*e.medicines.price,sale_date:s.toISOString(),customer_name:r[Math.floor(Math.random()*r.length)],prescription_required:Math.random()>.5})}}let{error:s}=await w.from("sales").insert(t);if(s)throw s;e.push(`Created ${t.length} sales records`)}let{data:s}=await w.from("inventory").select(`
        medicine_id,
        quantity,
        reorder_level,
        medicines (name)
      `).lt("quantity",50).limit(5);if(s&&s.length>0){let t=s.map(e=>({type:"low_stock",message:`Low stock alert: ${e.medicines.name} has only ${e.quantity} units remaining`,severity:e.quantity<=10?"high":e.quantity<=20?"medium":"low",is_read:!1,medicine_id:e.medicine_id,created_at:new Date().toISOString()})),{error:r}=await w.from("alerts").insert(t);if(r)throw r;e.push(`Created ${t.length} low stock alerts`)}return v.NextResponse.json({success:!0,message:"Sample data setup completed successfully",results:e})}catch(e){return console.error("Error setting up sample data:",e),v.NextResponse.json({error:"Failed to setup sample data"},{status:500})}}async function C(){try{let e=["medicines","inventory","sales","alerts","suppliers","supplier_medicines","supplier_orders","inventory_batches","drug_substitutes","drug_substitution_logs","low_stock_requests","supply_requests","purchase_orders","audit_logs"],t=[];for(let r of e)try{let{count:e,error:a}=await w.from(r).select("*",{count:"exact",head:!0});t.push({table:r,exists:!a,count:e||0,required:["medicines","inventory","sales","alerts"].includes(r)})}catch(e){t.push({table:r,exists:!1,count:0,required:["medicines","inventory","sales","alerts"].includes(r)})}let r=t.filter(e=>e.exists).length,a=4===t.filter(e=>e.required&&e.exists).length;return v.NextResponse.json({success:!0,schemaReady:a,tablesFound:`${r}/${e.length}`,tableStatus:t,message:a?"Database schema is ready for smart pharmacy features":"Please run the pharmacy_features_schema.sql script first"})}catch(e){return console.error("Error verifying schema:",e),v.NextResponse.json({error:"Failed to verify schema"},{status:500})}}async function E(){return v.NextResponse.json({message:"Database Setup API",endpoints:{"POST /api/setup-database":"Setup database and sample data",body:{action:"check_readiness | setup_sample_data | verify_schema"}}})}e.s(["GET",()=>E,"POST",()=>R],75718);var A=e.i(75718);let q=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/setup-database/route",pathname:"/api/setup-database",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/setup-database/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:S,workUnitAsyncStorage:M,serverHooks:N}=q;function P(){return(0,a.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:M})}async function O(e,t,a){q.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/setup-database/route";v=v.replace(/\/index$/,"")||"/";let w=await q.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:R,params:b,nextConfig:x,parsedUrl:C,isDraftMode:E,prerenderManifest:A,routerServerContext:S,isOnDemandRevalidate:M,revalidateOnlyGenerated:N,resolvedPathname:P,clientReferenceManifest:O,serverActionsManifest:T}=w,k=(0,l.normalizeAppPath)(v),D=!!(A.dynamicRoutes[k]||A.routes[P]),I=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,C,!1):t.end("This page could not be found"),null);if(D&&!E){let e=!!A.routes[P],t=A.dynamicRoutes[k];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await I();throw new y.NoFallbackError}}let j=null;!D||q.isDev||E||(j="/index"===(j=P)?"/":j);let H=!0===q.isDev||!D,$=D&&!H;T&&O&&(0,n.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:O,serverActionsManifest:T,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:T})});let U=e.method||"GET",F=(0,i.getTracer)(),K=F.getActiveScopeSpan(),L={params:b,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:H,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>q.onRequestError(e,t,a,S)},sharedContext:{buildId:R}},B=new c.NodeNextRequest(e),z=new c.NodeNextResponse(t),G=d.NextRequestAdapter.fromNodeNextRequest(B,(0,d.signalFromNodeResponse)(t));try{let n=async e=>q.handle(G,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${U} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${v}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var i,l;let c=async({previousCacheEntry:r})=>{try{if(!o&&M&&N&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await n(s);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=L.renderOpts.collectedTags;if(!D)return await (0,m.sendResponse)(B,z,i,L.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,a=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:_.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await q.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:M})},S),t}},d=await q.handleResponse({req:e,nextConfig:x,cacheKey:j,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:M,revalidateOnlyGenerated:N,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!D)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==_.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",M?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&D||u.delete(g.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,m.sendResponse)(B,z,new Response(d.value.body,{headers:u,status:d.value.status||200})),null};K?await l(K):await F.withPropagatedContext(e.headers,()=>F.trace(u.BaseServerSpan.handleRequest,{spanName:`${U} ${v}`,kind:i.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await q.onRequestError(e,t,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:M})}),D)throw t;return await (0,m.sendResponse)(B,z,new Response(null,{status:500})),null}}e.s(["handler",()=>O,"patchFetch",()=>P,"routeModule",()=>q,"serverHooks",()=>N,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>M],63865)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_7b6362fd.js.map